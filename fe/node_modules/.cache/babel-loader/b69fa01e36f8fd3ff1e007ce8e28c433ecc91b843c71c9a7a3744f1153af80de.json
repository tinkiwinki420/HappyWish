{"ast":null,"code":"const handleMealSelection = meal => {\n  if (selectedMeal && selectedMeal.id === meal.id) {\n    // If the selected meal is clicked again, unselect it\n    setSelectedMeal(null);\n    setTotalPrice(pricePerEvent);\n    setAdvancePayment(pricePerEvent * 0.05); // Reset to just the event price without the meal\n  } else {\n    // Select the meal and update the total price\n    setSelectedMeal(meal);\n    calculateTotalPrice(meal.price);\n  }\n};\nexport const handleTimeSelection = ({\n  time,\n  category,\n  numOfPeople,\n  minGuests,\n  hallCapacity,\n  setShowModal,\n  setShowMealsSelection,\n  setTotalPrice,\n  pricePerEvent,\n  handleBooking\n}) => {\n  if (category === \"Hall\") {\n    if (!numOfPeople || numOfPeople < minGuests || numOfPeople > hallCapacity) {\n      alert(`The number of people must be between ${minGuests} and ${hallCapacity}.`);\n      return;\n    }\n    setShowModal(false);\n    setShowMealsSelection(true);\n  } else {\n    setTotalPrice(pricePerEvent);\n    setShowModal(false);\n    handleBooking(time);\n  }\n};\nexport const handleBooking = ({\n  timeSlot,\n  selectedMeal,\n  category,\n  numOfPeople,\n  userId,\n  selectedDate,\n  totalPrice,\n  advancePayment,\n  closeForm\n}) => {\n  if (!timeSlot) {\n    alert(\"Please select a time slot before booking.\");\n    return;\n  }\n  const remainingBalance = (totalPrice - advancePayment).toFixed(2);\n  let bookingDetails = {\n    business_id: userId,\n    user_id: localStorage.getItem(\"userId\"),\n    date: selectedDate.toISOString().split(\"T\")[0],\n    time_slot: timeSlot,\n    num_of_people: category === \"Hall\" ? numOfPeople : null,\n    total_price: totalPrice,\n    advance_payment: advancePayment,\n    remaining_balance: remainingBalance\n  };\n  if (category === \"Hall\" && selectedMeal) {\n    bookingDetails = {\n      ...bookingDetails,\n      meal_name: selectedMeal.name,\n      meal_price: selectedMeal.price,\n      meal_image: `/uploads/${selectedMeal.image}`\n    };\n  }\n  fetch(`/api/profile/business/bookings/regular`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify(bookingDetails)\n  }).then(response => response.json()).then(data => {\n    if (data.message === \"Booking created successfully\") {\n      alert(\"Booking successfully created!\");\n      closeForm();\n    } else {\n      alert(data.message);\n    }\n  }).catch(error => {\n    console.error(\"Error storing date selection:\", error.message);\n    alert(\"Error storing date selection. Please try again later.\");\n  });\n};","map":{"version":3,"names":["handleMealSelection","meal","selectedMeal","id","setSelectedMeal","setTotalPrice","pricePerEvent","setAdvancePayment","calculateTotalPrice","price","handleTimeSelection","time","category","numOfPeople","minGuests","hallCapacity","setShowModal","setShowMealsSelection","handleBooking","alert","timeSlot","userId","selectedDate","totalPrice","advancePayment","closeForm","remainingBalance","toFixed","bookingDetails","business_id","user_id","localStorage","getItem","date","toISOString","split","time_slot","num_of_people","total_price","advance_payment","remaining_balance","meal_name","name","meal_price","meal_image","image","fetch","method","headers","body","JSON","stringify","then","response","json","data","message","catch","error","console"],"sources":["C:/Users/Admin/Downloads/React_Node_Sql_Path2-main/React_Node_Sql_Path2-main/fe/src/components/Dates/handlers/BookingHandlers.js"],"sourcesContent":["const handleMealSelection = (meal) => {\n  if (selectedMeal && selectedMeal.id === meal.id) {\n    // If the selected meal is clicked again, unselect it\n    setSelectedMeal(null);\n    setTotalPrice(pricePerEvent);\n    setAdvancePayment(pricePerEvent * 0.05); // Reset to just the event price without the meal\n  } else {\n    // Select the meal and update the total price\n    setSelectedMeal(meal);\n    calculateTotalPrice(meal.price);\n  }\n};\nexport const handleTimeSelection = ({ time, category, numOfPeople, minGuests, hallCapacity, setShowModal, setShowMealsSelection, setTotalPrice, pricePerEvent, handleBooking }) => {\n  if (category === \"Hall\") {\n    if (!numOfPeople || numOfPeople < minGuests || numOfPeople > hallCapacity) {\n      alert(`The number of people must be between ${minGuests} and ${hallCapacity}.`);\n      return;\n    }\n    setShowModal(false);\n    setShowMealsSelection(true);\n  } else {\n    setTotalPrice(pricePerEvent);\n    setShowModal(false);\n    handleBooking(time);\n  }\n};\n\nexport const handleBooking = ({ timeSlot, selectedMeal, category, numOfPeople, userId, selectedDate, totalPrice, advancePayment, closeForm }) => {\n  if (!timeSlot) {\n    alert(\"Please select a time slot before booking.\");\n    return;\n  }\n\n  const remainingBalance = (totalPrice - advancePayment).toFixed(2);\n  let bookingDetails = {\n    business_id: userId,\n    user_id: localStorage.getItem(\"userId\"),\n    date: selectedDate.toISOString().split(\"T\")[0],\n    time_slot: timeSlot,\n    num_of_people: category === \"Hall\" ? numOfPeople : null,\n    total_price: totalPrice,\n    advance_payment: advancePayment,\n    remaining_balance: remainingBalance,\n  };\n\n  if (category === \"Hall\" && selectedMeal) {\n    bookingDetails = {\n      ...bookingDetails,\n      meal_name: selectedMeal.name,\n      meal_price: selectedMeal.price,\n      meal_image: `/uploads/${selectedMeal.image}`,\n    };\n  }\n\n  fetch(`/api/profile/business/bookings/regular`, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify(bookingDetails),\n  })\n    .then((response) => response.json())\n    .then((data) => {\n      if (data.message === \"Booking created successfully\") {\n        alert(\"Booking successfully created!\");\n        closeForm();\n      } else {\n        alert(data.message);\n      }\n    })\n    .catch((error) => {\n      console.error(\"Error storing date selection:\", error.message);\n      alert(\"Error storing date selection. Please try again later.\");\n    });\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}