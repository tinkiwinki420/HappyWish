{"ast":null,"code":"export const handleMealSelection = ({\n  meal,\n  selectedMeal,\n  setSelectedMeal,\n  setTotalPrice,\n  pricePerEvent,\n  setAdvancePayment,\n  numOfPeople // Ensure numOfPeople is passed as an argument\n}) => {\n  if (selectedMeal && selectedMeal.id === meal.id) {\n    // If the same meal is selected again, deselect it\n    setSelectedMeal(null);\n    setTotalPrice(pricePerEvent); // Only event price is considered\n    setAdvancePayment(pricePerEvent * 0.05); // Calculate 5% advance payment\n  } else {\n    // Select the meal and calculate the total price and advance payment\n    setSelectedMeal(meal);\n    setTotalPrice(meal.price * numOfPeople + pricePerEvent); // Calculate total price\n    setAdvancePayment(((meal.price * numOfPeople + pricePerEvent) * 0.05).toFixed(2)); // 5% advance payment\n  }\n};\nexport const handleTimeSelection = ({\n  time,\n  category,\n  numOfPeople,\n  minGuests,\n  hallCapacity,\n  setShowModal,\n  setShowMealsSelection,\n  setTotalPrice,\n  pricePerEvent,\n  handleBooking\n}) => {\n  if (category === \"Hall\") {\n    // Validate the number of people\n    if (!numOfPeople || numOfPeople < minGuests || numOfPeople > hallCapacity) {\n      alert(`The number of people must be between ${minGuests} and ${hallCapacity}.`);\n      return;\n    }\n    setShowModal(false); // Close time selection modal\n    setShowMealsSelection(true); // Show meal selection modal\n  } else {\n    // Non-Hall booking\n    setTotalPrice(pricePerEvent); // Set total price as event price\n    setShowModal(false); // Close modal\n    handleBooking(time); // Proceed with booking\n  }\n};\nexport const handleBooking = ({\n  timeSlot,\n  selectedMeal,\n  category,\n  numOfPeople,\n  userId,\n  selectedDate,\n  totalPrice,\n  advancePayment,\n  closeForm\n}) => {\n  if (!timeSlot) {\n    alert(\"Please select a time slot before booking.\");\n    return;\n  }\n\n  // Calculate remaining balance\n  const remainingBalance = (totalPrice - advancePayment).toFixed(2);\n\n  // Create booking details object\n  let bookingDetails = {\n    business_id: userId,\n    user_id: localStorage.getItem(\"userId\"),\n    date: selectedDate.toISOString().split(\"T\")[0],\n    time_slot: timeSlot,\n    num_of_people: category === \"Hall\" ? numOfPeople : null,\n    total_price: totalPrice,\n    advance_payment: advancePayment,\n    remaining_balance: remainingBalance\n  };\n\n  // Include meal details if Hall booking\n  if (category === \"Hall\" && selectedMeal) {\n    bookingDetails = {\n      ...bookingDetails,\n      meal_name: selectedMeal.name,\n      meal_price: selectedMeal.price,\n      meal_image: `/uploads/${selectedMeal.image}`\n    };\n  }\n\n  // Send booking details to the server\n  fetch(`/api/profile/business/bookings/regular`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify(bookingDetails)\n  }).then(response => response.json()).then(data => {\n    if (data.message === \"Booking created successfully\") {\n      alert(\"Booking successfully created!\");\n      closeForm(); // Reset form after booking\n    } else {\n      alert(data.message);\n    }\n  }).catch(error => {\n    console.error(\"Error storing date selection:\", error.message);\n    alert(\"Error storing date selection. Please try again later.\");\n  });\n};","map":{"version":3,"names":["handleMealSelection","meal","selectedMeal","setSelectedMeal","setTotalPrice","pricePerEvent","setAdvancePayment","numOfPeople","id","price","toFixed","handleTimeSelection","time","category","minGuests","hallCapacity","setShowModal","setShowMealsSelection","handleBooking","alert","timeSlot","userId","selectedDate","totalPrice","advancePayment","closeForm","remainingBalance","bookingDetails","business_id","user_id","localStorage","getItem","date","toISOString","split","time_slot","num_of_people","total_price","advance_payment","remaining_balance","meal_name","name","meal_price","meal_image","image","fetch","method","headers","body","JSON","stringify","then","response","json","data","message","catch","error","console"],"sources":["C:/Users/Admin/Downloads/React_Node_Sql_Path2-main/React_Node_Sql_Path2-main/fe/src/components/Dates/handlers/BookingHandlers.js"],"sourcesContent":["export const handleMealSelection = ({\n  meal,\n  selectedMeal,\n  setSelectedMeal,\n  setTotalPrice,\n  pricePerEvent,\n  setAdvancePayment,\n  numOfPeople,  // Ensure numOfPeople is passed as an argument\n}) => {\n  if (selectedMeal && selectedMeal.id === meal.id) {\n    // If the same meal is selected again, deselect it\n    setSelectedMeal(null);\n    setTotalPrice(pricePerEvent); // Only event price is considered\n    setAdvancePayment(pricePerEvent * 0.05); // Calculate 5% advance payment\n  } else {\n    // Select the meal and calculate the total price and advance payment\n    setSelectedMeal(meal);\n    setTotalPrice(meal.price * numOfPeople + pricePerEvent); // Calculate total price\n    setAdvancePayment(((meal.price * numOfPeople + pricePerEvent) * 0.05).toFixed(2)); // 5% advance payment\n  }\n};\n\nexport const handleTimeSelection = ({\n  time,\n  category,\n  numOfPeople,\n  minGuests,\n  hallCapacity,\n  setShowModal,\n  setShowMealsSelection,\n  setTotalPrice,\n  pricePerEvent,\n  handleBooking,\n}) => {\n  if (category === \"Hall\") {\n    // Validate the number of people\n    if (!numOfPeople || numOfPeople < minGuests || numOfPeople > hallCapacity) {\n      alert(`The number of people must be between ${minGuests} and ${hallCapacity}.`);\n      return;\n    }\n    setShowModal(false); // Close time selection modal\n    setShowMealsSelection(true); // Show meal selection modal\n  } else {\n    // Non-Hall booking\n    setTotalPrice(pricePerEvent); // Set total price as event price\n    setShowModal(false); // Close modal\n    handleBooking(time); // Proceed with booking\n  }\n};\n\nexport const handleBooking = ({\n  timeSlot,\n  selectedMeal,\n  category,\n  numOfPeople,\n  userId,\n  selectedDate,\n  totalPrice,\n  advancePayment,\n  closeForm,\n}) => {\n  if (!timeSlot) {\n    alert(\"Please select a time slot before booking.\");\n    return;\n  }\n\n  // Calculate remaining balance\n  const remainingBalance = (totalPrice - advancePayment).toFixed(2);\n  \n  // Create booking details object\n  let bookingDetails = {\n    business_id: userId,\n    user_id: localStorage.getItem(\"userId\"),\n    date: selectedDate.toISOString().split(\"T\")[0],\n    time_slot: timeSlot,\n    num_of_people: category === \"Hall\" ? numOfPeople : null,\n    total_price: totalPrice,\n    advance_payment: advancePayment,\n    remaining_balance: remainingBalance,\n  };\n\n  // Include meal details if Hall booking\n  if (category === \"Hall\" && selectedMeal) {\n    bookingDetails = {\n      ...bookingDetails,\n      meal_name: selectedMeal.name,\n      meal_price: selectedMeal.price,\n      meal_image: `/uploads/${selectedMeal.image}`,\n    };\n  }\n\n  // Send booking details to the server\n  fetch(`/api/profile/business/bookings/regular`, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify(bookingDetails),\n  })\n    .then((response) => response.json())\n    .then((data) => {\n      if (data.message === \"Booking created successfully\") {\n        alert(\"Booking successfully created!\");\n        closeForm(); // Reset form after booking\n      } else {\n        alert(data.message);\n      }\n    })\n    .catch((error) => {\n      console.error(\"Error storing date selection:\", error.message);\n      alert(\"Error storing date selection. Please try again later.\");\n    });\n};\n"],"mappings":"AAAA,OAAO,MAAMA,mBAAmB,GAAGA,CAAC;EAClCC,IAAI;EACJC,YAAY;EACZC,eAAe;EACfC,aAAa;EACbC,aAAa;EACbC,iBAAiB;EACjBC,WAAW,CAAG;AAChB,CAAC,KAAK;EACJ,IAAIL,YAAY,IAAIA,YAAY,CAACM,EAAE,KAAKP,IAAI,CAACO,EAAE,EAAE;IAC/C;IACAL,eAAe,CAAC,IAAI,CAAC;IACrBC,aAAa,CAACC,aAAa,CAAC,CAAC,CAAC;IAC9BC,iBAAiB,CAACD,aAAa,GAAG,IAAI,CAAC,CAAC,CAAC;EAC3C,CAAC,MAAM;IACL;IACAF,eAAe,CAACF,IAAI,CAAC;IACrBG,aAAa,CAACH,IAAI,CAACQ,KAAK,GAAGF,WAAW,GAAGF,aAAa,CAAC,CAAC,CAAC;IACzDC,iBAAiB,CAAC,CAAC,CAACL,IAAI,CAACQ,KAAK,GAAGF,WAAW,GAAGF,aAAa,IAAI,IAAI,EAAEK,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACrF;AACF,CAAC;AAED,OAAO,MAAMC,mBAAmB,GAAGA,CAAC;EAClCC,IAAI;EACJC,QAAQ;EACRN,WAAW;EACXO,SAAS;EACTC,YAAY;EACZC,YAAY;EACZC,qBAAqB;EACrBb,aAAa;EACbC,aAAa;EACba;AACF,CAAC,KAAK;EACJ,IAAIL,QAAQ,KAAK,MAAM,EAAE;IACvB;IACA,IAAI,CAACN,WAAW,IAAIA,WAAW,GAAGO,SAAS,IAAIP,WAAW,GAAGQ,YAAY,EAAE;MACzEI,KAAK,CAAE,wCAAuCL,SAAU,QAAOC,YAAa,GAAE,CAAC;MAC/E;IACF;IACAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC;IACrBC,qBAAqB,CAAC,IAAI,CAAC,CAAC,CAAC;EAC/B,CAAC,MAAM;IACL;IACAb,aAAa,CAACC,aAAa,CAAC,CAAC,CAAC;IAC9BW,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC;IACrBE,aAAa,CAACN,IAAI,CAAC,CAAC,CAAC;EACvB;AACF,CAAC;AAED,OAAO,MAAMM,aAAa,GAAGA,CAAC;EAC5BE,QAAQ;EACRlB,YAAY;EACZW,QAAQ;EACRN,WAAW;EACXc,MAAM;EACNC,YAAY;EACZC,UAAU;EACVC,cAAc;EACdC;AACF,CAAC,KAAK;EACJ,IAAI,CAACL,QAAQ,EAAE;IACbD,KAAK,CAAC,2CAA2C,CAAC;IAClD;EACF;;EAEA;EACA,MAAMO,gBAAgB,GAAG,CAACH,UAAU,GAAGC,cAAc,EAAEd,OAAO,CAAC,CAAC,CAAC;;EAEjE;EACA,IAAIiB,cAAc,GAAG;IACnBC,WAAW,EAAEP,MAAM;IACnBQ,OAAO,EAAEC,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAC;IACvCC,IAAI,EAAEV,YAAY,CAACW,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;IAC9CC,SAAS,EAAEf,QAAQ;IACnBgB,aAAa,EAAEvB,QAAQ,KAAK,MAAM,GAAGN,WAAW,GAAG,IAAI;IACvD8B,WAAW,EAAEd,UAAU;IACvBe,eAAe,EAAEd,cAAc;IAC/Be,iBAAiB,EAAEb;EACrB,CAAC;;EAED;EACA,IAAIb,QAAQ,KAAK,MAAM,IAAIX,YAAY,EAAE;IACvCyB,cAAc,GAAG;MACf,GAAGA,cAAc;MACjBa,SAAS,EAAEtC,YAAY,CAACuC,IAAI;MAC5BC,UAAU,EAAExC,YAAY,CAACO,KAAK;MAC9BkC,UAAU,EAAG,YAAWzC,YAAY,CAAC0C,KAAM;IAC7C,CAAC;EACH;;EAEA;EACAC,KAAK,CAAE,wCAAuC,EAAE;IAC9CC,MAAM,EAAE,MAAM;IACdC,OAAO,EAAE;MAAE,cAAc,EAAE;IAAmB,CAAC;IAC/CC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACvB,cAAc;EACrC,CAAC,CAAC,CACCwB,IAAI,CAAEC,QAAQ,IAAKA,QAAQ,CAACC,IAAI,CAAC,CAAC,CAAC,CACnCF,IAAI,CAAEG,IAAI,IAAK;IACd,IAAIA,IAAI,CAACC,OAAO,KAAK,8BAA8B,EAAE;MACnDpC,KAAK,CAAC,+BAA+B,CAAC;MACtCM,SAAS,CAAC,CAAC,CAAC,CAAC;IACf,CAAC,MAAM;MACLN,KAAK,CAACmC,IAAI,CAACC,OAAO,CAAC;IACrB;EACF,CAAC,CAAC,CACDC,KAAK,CAAEC,KAAK,IAAK;IAChBC,OAAO,CAACD,KAAK,CAAC,+BAA+B,EAAEA,KAAK,CAACF,OAAO,CAAC;IAC7DpC,KAAK,CAAC,uDAAuD,CAAC;EAChE,CAAC,CAAC;AACN,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}