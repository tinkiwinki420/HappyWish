{"ast":null,"code":"export const handleMealSelection = ({\n  meal,\n  selectedMeal,\n  setSelectedMeal,\n  setTotalPrice,\n  pricePerEvent,\n  setAdvancePayment,\n  numOfPeople\n}) => {\n  if (selectedMeal && selectedMeal.id === meal.id) {\n    setSelectedMeal(null);\n    setTotalPrice(pricePerEvent);\n    setAdvancePayment(pricePerEvent * 0.05);\n  } else {\n    setSelectedMeal(meal);\n    setTotalPrice(meal.price * numOfPeople + pricePerEvent);\n    setAdvancePayment(((meal.price * 1 + pricePerEvent) * 0.05).toFixed(2));\n  }\n};\nexport const handleTimeSelection = ({\n  time,\n  category,\n  numOfPeople,\n  minGuests,\n  hallCapacity,\n  setShowModal,\n  setShowMealsSelection,\n  setTotalPrice,\n  pricePerEvent,\n  handleBooking\n}) => {\n  if (category === \"Hall\") {\n    if (!numOfPeople || numOfPeople < minGuests || numOfPeople > hallCapacity) {\n      alert(`The number of people must be between ${minGuests} and ${hallCapacity}.`);\n      return;\n    }\n    setShowModal(false);\n    setShowMealsSelection(true);\n  } else {\n    setTotalPrice(pricePerEvent);\n    setShowModal(false);\n    handleBooking(time);\n  }\n};\nexport const handleBooking = ({\n  timeSlot,\n  selectedMeal,\n  category,\n  numOfPeople,\n  userId,\n  selectedDate,\n  totalPrice,\n  advancePayment,\n  closeForm\n}) => {\n  if (!timeSlot) {\n    alert(\"Please select a time slot before booking.\");\n    return;\n  }\n  const remainingBalance = (totalPrice - advancePayment).toFixed(2);\n  let bookingDetails = {\n    business_id: userId,\n    user_id: localStorage.getItem(\"userId\"),\n    date: selectedDate.toISOString().split(\"T\")[0],\n    time_slot: timeSlot,\n    num_of_people: category === \"Hall\" ? numOfPeople : null,\n    total_price: totalPrice,\n    advance_payment: advancePayment,\n    remaining_balance: remainingBalance\n  };\n  if (category === \"Hall\" && selectedMeal) {\n    bookingDetails = {\n      ...bookingDetails,\n      meal_name: selectedMeal.name,\n      meal_price: selectedMeal.price,\n      meal_image: `/uploads/${selectedMeal.image}`\n    };\n  }\n  fetch(`/api/profile/business/bookings/regular`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify(bookingDetails)\n  }).then(response => response.json()).then(data => {\n    if (data.message === \"Booking created successfully\") {\n      alert(\"Booking successfully created!\");\n      closeForm();\n    } else {\n      alert(data.message);\n    }\n  }).catch(error => {\n    console.error(\"Error storing date selection:\", error.message);\n    alert(\"Error storing date selection. Please try again later.\");\n  });\n};","map":{"version":3,"names":["handleMealSelection","meal","selectedMeal","setSelectedMeal","setTotalPrice","pricePerEvent","setAdvancePayment","numOfPeople","id","price","toFixed","handleTimeSelection","time","category","minGuests","hallCapacity","setShowModal","setShowMealsSelection","handleBooking","alert","timeSlot","userId","selectedDate","totalPrice","advancePayment","closeForm","remainingBalance","bookingDetails","business_id","user_id","localStorage","getItem","date","toISOString","split","time_slot","num_of_people","total_price","advance_payment","remaining_balance","meal_name","name","meal_price","meal_image","image","fetch","method","headers","body","JSON","stringify","then","response","json","data","message","catch","error","console"],"sources":["C:/Users/Admin/Downloads/React_Node_Sql_Path2-main/React_Node_Sql_Path2-main/fe/src/components/Dates/handlers/BookingHandlers.js"],"sourcesContent":["export const handleMealSelection = ({ meal, selectedMeal, setSelectedMeal, setTotalPrice, pricePerEvent, setAdvancePayment ,numOfPeople}) => {\n  if (selectedMeal && selectedMeal.id === meal.id) {\n    setSelectedMeal(null);\n    setTotalPrice(pricePerEvent);\n    setAdvancePayment(pricePerEvent * 0.05);\n  } else {\n    setSelectedMeal(meal);\n    setTotalPrice(meal.price * numOfPeople + pricePerEvent);\n    setAdvancePayment(((meal.price * 1 + pricePerEvent) * 0.05).toFixed(2));\n  }\n};\n\nexport const handleTimeSelection = ({ time, category, numOfPeople, minGuests, hallCapacity, setShowModal, setShowMealsSelection, setTotalPrice, pricePerEvent, handleBooking }) => {\n  if (category === \"Hall\") {\n    if (!numOfPeople || numOfPeople < minGuests || numOfPeople > hallCapacity) {\n      alert(`The number of people must be between ${minGuests} and ${hallCapacity}.`);\n      return;\n    }\n    setShowModal(false);\n    setShowMealsSelection(true);\n  } else {\n    setTotalPrice(pricePerEvent);\n    setShowModal(false);\n    handleBooking(time);\n  }\n};\n\nexport const handleBooking = ({ timeSlot, selectedMeal, category, numOfPeople, userId, selectedDate, totalPrice, advancePayment, closeForm }) => {\n  if (!timeSlot) {\n    alert(\"Please select a time slot before booking.\");\n    return;\n  }\n\n  const remainingBalance = (totalPrice - advancePayment).toFixed(2);\n  let bookingDetails = {\n    business_id: userId,\n    user_id: localStorage.getItem(\"userId\"),\n    date: selectedDate.toISOString().split(\"T\")[0],\n    time_slot: timeSlot,\n    num_of_people: category === \"Hall\" ? numOfPeople : null,\n    total_price: totalPrice,\n    advance_payment: advancePayment,\n    remaining_balance: remainingBalance,\n  };\n\n  if (category === \"Hall\" && selectedMeal) {\n    bookingDetails = {\n      ...bookingDetails,\n      meal_name: selectedMeal.name,\n      meal_price: selectedMeal.price,\n      meal_image: `/uploads/${selectedMeal.image}`,\n    };\n  }\n\n  fetch(`/api/profile/business/bookings/regular`, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify(bookingDetails),\n  })\n    .then((response) => response.json())\n    .then((data) => {\n      if (data.message === \"Booking created successfully\") {\n        alert(\"Booking successfully created!\");\n        closeForm();\n      } else {\n        alert(data.message);\n      }\n    })\n    .catch((error) => {\n      console.error(\"Error storing date selection:\", error.message);\n      alert(\"Error storing date selection. Please try again later.\");\n    });\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}